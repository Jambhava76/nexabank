<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>OTP Verification</title>

    <style>
        body{
            background: linear-gradient(to right,#0d1b3d,#1d3a73);
            height:100vh;display:flex;justify-content:center;align-items:center;
            font-family:Segoe UI,sans-serif;color:#fff;margin:0;
        }
        .box{
            background:#fff;color:#0d1b3d;width:420px;padding:35px 30px;
            border-radius:15px;text-align:center;
            box-shadow:0px 0px 30px rgba(255,255,255,0.25);
        }
        input{
            width:100%;padding:12px;font-size:18px;
            border:1px solid #bbb;border-radius:8px;margin-top:12px;
        }
        button{
            width:100%;padding:14px;margin-top:22px;background:#f5c542;border:0;
            border-radius:8px;font-size:18px;font-weight:600;cursor:pointer;
        }
        button:hover{background:#e1b336;}
        .timer{margin-top:10px;font-size:16px;color:red;font-weight:600;}
        .msg{margin-top:12px;font-weight:600;}
        .resend-btn { background:#1f3c66;color:white;border-radius:8px;padding:12px;border:0; cursor:pointer; }
        .resend-btn:hover { filter:brightness(.95); }
    </style>

</head>
<body>

<div class="box">
    <h2>Enter OTP sent to your Email</h2>

    <!-- POST to the Major verification endpoint -->
    <form th:action="@{/major/verify-otp}" method="post">
        <!-- hidden email (must be present) -->
        <input type="hidden" name="email" th:value="${email}">
        <input type="text" name="otp" placeholder="Enter OTP" required>
        <button type="submit">Verify</button>
    </form>

    <p class="msg" th:if="${expired}" th:text="${expired}" style="color:red;"></p>
    <p class="msg" th:if="${message}" th:text="${message}" style="color:green;"></p>

    <!-- Countdown Timer -->
    <p class="timer" id="timer">OTP expires in 02:00</p>

    <!-- Resend OTP for major -> posts to controller endpoint /major/resend-otp -->
    <form th:action="@{/major/resend-otp}" method="post" style="margin-top:14px;">
        <input type="hidden" name="email" th:value="${email}">
        <button type="submit" class="resend-btn">Resend OTP</button>
    </form>
</div>

<script>
    let timeLeft = 120; // seconds
    const timer = document.getElementById("timer");

    const countdown = setInterval(() => {
        let minutes = Math.floor(timeLeft / 60);
        let seconds = timeLeft % 60;

        seconds = seconds < 10 ? "0" + seconds : seconds;
        timer.innerText = `OTP expires in ${minutes}:${seconds}`;

        if(timeLeft <= 0){
            clearInterval(countdown);
            timer.innerText = "OTP expired! Please resend.";
        }
        timeLeft--;
    }, 1000);
</script>

</body>
</html>
